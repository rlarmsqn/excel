<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jbt.water.WaterMapper">
    <insert id="insertWaterLevel" parameterType="java.util.List">
        INSERT INTO water_level (
            STATION_NAME,
            YMD,
            LEVEL
        ) VALUES
        <foreach collection="list" item="item" separator=",">
        (
            #{item.stationName},
            #{item.ymd},
            #{item.level}
        )
        </foreach>
    </insert>

    <insert id="insertWaterInfo" parameterType="com.jbt.water.vo.WaterInfoVO">
        INSERT INTO water_level_info (
            STATION_NAME,
            LAT,
            LON,
            RIVER,
            ALTITUDE,
            CATCHMENT_AREA,
            PROVINCE,
            COUNTRY,
            AGENCY
        ) VALUES (
            #{stationName},
            #{lat},
            #{lon},
            #{river},
            #{altitude},
            #{catchmentArea},
            #{province},
            #{country},
            #{agency}
        )
    </insert>

    <select id="stationNameCheck" parameterType="java.lang.String" resultType="java.lang.Integer">
        SELECT COUNT(STATION_NAME) FROM WATER_LEVEL_INFO WHERE STATION_NAME = #{value}
    </select>
</mapper>
